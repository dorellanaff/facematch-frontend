<p-toast />

<div id="webcamFaceComponent" class="relative md:max-w-2xl md:mx-auto w-full h-screen flex flex-col">
    
    <span class="loading absolute loading-dots loading-lg" *ngIf="!videoLoaded" [ngClass]="{'hidden': resultCheck}" style="top: 15%; left: 50%; transform: translate(-50%, -50%); font-size: 2rem;"></span>
    <span class="loading absolute loading-spinner loading-lg" *ngIf="photoTaken" [ngClass]="{'hidden': resultCheck}" style="top: 15%; left: 50%; transform: translate(-50%, -50%); font-size: 2rem;"></span>
        
    @if (resultCheck && photoTaken) {
        <p class="text-4xl font-bold">{{resultMessageLiveness}}</p>
        <p class="text-4xl font-bold">{{resultMessageMatchFace}}</p>
    }

    <div class="relative" *ngIf="!photoTaken" [ngClass]="{'hidden': !videoLoaded}">
        <div class="flex justify-between items-center">
            <div class="w-5%">
            <button (click)="closeModal()" class="w-full h-full bg-red-500 text-white px-4 py-2 rounded-md">X</button>
            </div>
            <div class="w-95% text-center absolute bottom-4 w-full flex justify-center">
                <p class="text-4xl font-bold">{{message}}</p>
            </div>
        </div>
    </div>

    <!-- Contenedor del video y canvas -->
    <div #videoContainer class="flex-grow relative" [ngClass]="{'hidden': photoTaken}">
        <video #video muted playsinline></video>
        <canvas #canvas hidden></canvas>
        <!--<canvas #canvas hidden width="{{ video?.offsetWidth ?? 0 + 5 }}" height="{{ video?.offsetHeight ?? 0 + 5 }}"></canvas>-->
    </div>



</div>

@if (debug){
    <div>
        <h2>Ms: {{meanTimeDetect}}</h2>
        <h2>Mobile: {{isMobile}}</h2>
        <h2>{{position}}</h2>
    </div>
    <a #downloadLink style="display:none">Download</a>

        <!-- Contenedor de imÃ¡genes debajo del video y canvas -->
    <div class="flex relative mt-4">
        <div class="grid grid-cols-1 gap-4">
            <h2>Audit</h2>
            @for (photo of listPhotosAudit; track photo) {
                <img class="relative mx-auto" [src]="photo" alt="Audit Photo" width="500" height="600">
            }
            
            <h2>Validate</h2>
            @for (photo of listPhotos; track photo) {
                <img class="relative mx-auto" [src]="photo" alt="Audit Photo" width="500" height="600">
            }
        </div>

    </div>
}
